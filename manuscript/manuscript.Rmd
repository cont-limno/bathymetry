---
title: Imperfect slope measurements drive overestimation in geometric cone model of waterbody depth

# Use letters for affiliations
author:
  - name: Jemma Stachelek
    affiliation: a,b,c
  - name: Patrick J. Hanly
    affiliation: c
  - name: Patricia A. Soranno
    affiliation: c
  
address:
  - code: a
    address: Earth and Environmental Sciences Division, Los Alamos National Laboratory, Los Alamos, NM, USA
  - code: b
    address: Center for Limnology, University of Wisconsin – Madison, Madison, WI, USA
  - code: c
    address: Department of Fisheries and Wildlife, Michigan State University, 480 Wilson Rd., East Lansing, MI 48824, USA
  
# Optional: line of arbitrary text with additional information.
# Could be used, for example, to mention the bibliographic info in a post-print.
# If not specified, defaults to "This version was compiled on \today"
date_subtitle: > 
  This is an Accepted Manuscript of an article to be published by Taylor & Francis in Inland Waters.
  


# For footer text  TODO(fold into template, allow free form two-authors)
lead_author_surname: Stachelek et al.

# Place eg a DOI URL or CRAN Package URL here
# doi_footer: "https://doi.org/10.5281/zenodo.3754916"

# Abstract
abstract: |
  Lake and reservoir (waterbody) depth is a critical characteristic that influences many important ecological processes. Unfortunately, waterbody depth measurements are labor-intensive to gather and are only available for a small fraction of waterbodies globally. Therefore, scientists have tried to predict waterbody depth from characteristics that are easily obtained for all waterbodies such as waterbody surface area or the slope of the land surrounding a waterbody. One approach for predicting waterbody depth simulates waterbody basins using a geometric cone model where nearshore land slope is assumed to be a representative proxy for in-lake slope and the distance to the center of the waterbody is assumed to be a representative proxy for the distance to the deepest point of the waterbody. However, these assumptions have rarely been tested in a broad range of waterbodies. We used bathymetry data from approximately 5,000 lakes and reservoirs to test the assumptions of the cone model and to examine whether differences in waterbody type or shape influences depth prediction error. We found that nearshore land slope was not representative of in-lake slope and using it for prediction increases error substantially relative to models using true in-lake slope. We also found that models using nearshore land slope as a proxy systematically overpredict depth in concave waterbodies (i.e. bowl-shaped; up to 18\% of waterbodies in the study population) and reservoir waterbodies (up to 30\% of waterbodies in the study population). Nevertheless, model errors were low (in absolute and relative terms) for concave waterbodies, suggesting that the cone model is an adequate representation of depth for these waterbodies.

# Optional: Acknowledgements
acknowledgements: |
This work was supported by the U.S. National Science Foundation (NSF) Macrosystems Biology Program (awards EF-1638679, EF-1638554, EF-1638539, and EF-1638550). JS was also supported by the NSF Harnessing the Data Revolution Program (OAC-1934633) and Los Alamos National Laboratory (LDRD-20210213ER). PAS was also supported by the USDA National Institute of Food and Agriculture, Hatch project 1013544. Author contributions: JS conceived of the study, built models, analyzed data, and wrote the paper. PJH and PAS contributed to the conception of the manuscript, provided interpretation of results, and edited the paper. This work benefited from participation in the Global Lake Ecological Observatory Network (GLEON). We thank K.S. Cheruvelil for a friendly review of an earlier draft.


# Optional: One or more keywords
keywords:
  - lake depth
  - cone model
  - slope
  - bathymetry
  - hypsography
  - reservoir

# Paper size for the document, values of letter and a4
papersize: letter

# Font size of the document, values of 9pt (default), 10pt, 11pt and 12pt
fontsize: 9pt

# Optional: Force one-column layout, default is two-column
#one_column: true

# Optional: Enables lineno mode, but only if one_column mode is also true
#lineno: true

# Optional: Enable one-sided layout, default is two-sided
#one_sided: true

# Optional: Enable section numbering, default is unnumbered
#numbersections: true

# Optional: Specify the depth of section number, default is 5
#secnumdepth: 5

# Optional: Skip inserting final break between acknowledgements, default is false
skip_final_break: true

# Optional: Bibliography 
bibliography: lagosdepth
biblio-style: jsta

# Optional: Enable a 'Draft' watermark on the document
watermark: true

# Customize footer, eg by referencing the vignette
footer_contents: "Geometric lake depth models and bathymetry"

# Produce a pinp document
output: pinp::pinp

# Required: Vignette metadata for inclusion in a package.
vignette: >
  %\VignetteIndexEntry{YourPackage-vignetteentry}
  %\VignetteKeywords{YourPackage, r, anotherkeyword}
  %\VignettePackage{YourPackage}
  %\VignetteEngine{knitr::rmarkdown}
---

## Introduction

Depth is an important factor controlling waterbody physics, chemistry, and biota. For example, deeper waterbodies generally have higher water clarity and less complete mixing compared to shallow waterbodies \citep{feeEffectsLakeSize1996, readSimulating2368Temperate2014}. These differences are reflected in variation among waterbodies in terms of biological productivity \citep{qinWaterDepthUnderpins2020} and rates of greenhouse gas production \citep{liSignificantContributionLake2020}. However, because measured depth data is only available for a small fraction of waterbodies (about 15% of all waterbodies in the area encompassed by our study), our ability to understand and predict depth-dependent processes is limited. The importance of waterbody depth, coupled with its limited availability, has led to numerous attempts to predict depth using measures available for all waterbodies such as waterbody surface area or the nearshore slope of the land surrounding a waterbody \citep{heathcotePredictingBathymetricFeatures2015, oliver2016prediction, sobekPredictingDepthVolume2011}. Such efforts rely on a strategy of exploiting correlations between nearshore geomorphology and in-lake geometry, which at limited extents (e.g., within a single North American state or province) can be quite strong, while at larger extents can be dependent on geographic location and waterbody type \citep{oliver2016prediction, branstrator2009origins}.

Given the limited prediction accuracy of prior depth prediction efforts (± 6-7 m, \citealt{heathcotePredictingBathymetricFeatures2015, oliver2016prediction, sobekPredictingDepthVolume2011}), a major focus has been on improving accuracy using strategies such as employing more diverse covariates \citep{oliver2016prediction}, varying waterbody buffer sizes \citep{heathcotePredictingBathymetricFeatures2015}, or estimating hidden groupings (e.g. fitting different models for distinct size classes) among waterbodies \citep{caelVolumeMeanDepth2017, sobekPredictingDepthVolume2011}. Unfortunately, the predictive accuracy of these efforts has been limited (± 6-7 m).

One intuitive approach for predicting waterbody depth involves using a geometric model that assumes waterbody basins correspond to an idealized shape such as a cone, bowl, or an elliptic sinusoid \citep{getiranaDerivingThreeDimensional2018, hollisterPredictingMaximumLake2011, neumannMaximumDepthAverage1959, yigzawNewGlobalStorage2018}. All such geometric models for waterbody depth prediction involve implicit assumptions about the terms of geometric formulae. In the simplest case, where waterbody basins are treated as cones (Eq. \ref{eq1}, Fig. \ref{fig1}), two assumptions are required to make depth predictions for all waterbodies: 1) that nearshore land slope is a representative proxy for in-lake slope and 2) that the distance to the center of the waterbody is a representative proxy for the distance to the deepest point of the waterbody (Fig. \ref{fig1}). This cone model imposes the following fixed (i.e. geometric) relationship between slope and horizontal distance:

\begin{align}
  depth_{geometric} = tan(slope) * distance \label{eq1}
\end{align}

\noindent where the product of slope and horizontal distance yields an exact geometric depth estimate ($depth_{geometric}$). Cone models of waterbody basins have been used extensively to estimate hypsography in waterbodies where there is no knowledge of volume or mean depth \citep{readSimulating2368Temperate2014, winslowLargescaleModeledContemporary2017}.


\begin{figure}
  \begin{center}
    \includegraphics[width=0.45\textwidth,keepaspectratio]{../figures/slope_diagram_new}
  \end{center}
  \caption{Diagram showing the relations between true (black) and proxy (orange) metrics of lake geometry. Geometric depth calculated via Equation \ref{eq1} requires a single distance and slope metric.}\label{fig1}
\end{figure}

The assumptions of the cone model (as well as other geometric models) can be tested by comparing proxy measures of waterbody geometry against corresponding “true” (i.e. in-lake) values derived from bathymetric maps and by evaluating how waterbody cross-section shapes differ from that of an idealized cone \citep{johanssonNewApproachesModelling2007}. For instance, waterbody cross-section shapes have been shown to vary from narrow "convex" forms to outstretched "concave" forms \citep{hakansonLakeFormLake1977}. Because tests of geometric model assumptions require bathymetric map data, which is only available for a small fraction of waterbodies (including about 15% of all waterbodies in our study footprint), existing evidence may not be applicable to all waterbodies. The few studies that have tested these assumptions have been limited to individual studies of very large (> 500 ha) waterbodies or studies on small numbers (< 100) of waterbodies \citep{johanssonNewApproachesModelling2007}. Studies focused specifically on reservoirs (as opposed to the more typical case where reservoirs and natural lakes are combined), have been even more restricted to that of large waterbodies > 1000 ha \citep{lehnerHighresolutionMappingWorld2011, messagerEstimatingVolumeAge2016}.

As a result of this limited testing, we lack knowledge on both the predictive performance of geometric models, the effect of proxies on depth prediction, and whether depth predictions are more sensitive to measurement errors in the horizontal dimension (i.e. distance to the deepest point of the waterbody) or measurement errors in the vertical dimension (i.e. in-lake slope). Additionally, it is unclear whether model prediction error is related to differences in waterbody type such those with different cross-section shapes (concave versus convex) or those classified as reservoirs versus natural lakes. To address these knowledge gaps, we asked three research questions: 

\begin{enumerate}
\item How representative is nearshore land slope of in-lake slope; and how representative is the distance to the center of a waterbody compared to the distance to the deepest point of a waterbody?
\item How does the use of proxies for waterbody geometry affect waterbody depth prediction error?
\item How does waterbody cross-section shape (i.e. concave versus convex) and waterbody type (i.e. natural lake vs reservoir) affect depth prediction error?
\end{enumerate}

To answer these questions, we extracted maximum depth (hereafter referred to as “observed maximum depth”), in-lake slope, cross-section shape (i.e., concave versus convex), and distance to the deepest point, of approximately 5,000 waterbodies from bathymetric map data. We supplemented these geometry measures with data classifying waterbodies as reservoirs or natural lakes. We used this data to compute geometric depth estimates (Equation \ref{eq1}) and prediction "offsets" to these estimates using the random forest algorithm (Equation \ref{eq3}). Such offsets are model quantities which minimize differences between observed and predicted depth as a function of covariates. In our case, covariates included a variety of waterbody, watershed, and hydrologic subbasin measures that are available for all waterbodies (Table \ref{table1}).

\begin{table}
  \caption{Summary of lake characteristics for the present study (and for lakes in the contiguous United States). Predictor variables for computing random forest offsets (Equation \ref{eq2}) are printed in bold face. Dashes (-) indicate an identical sample size among this study and that of the contiguous United States from the National Hydrography Dataset. The total number lakes is reported as n.} \label{table1}
  \centering
  \setlength\tabcolsep{1.5pt} % default value: 6pt
  \begin{tabular}{lllll}
    \hline
    Variable & Median & Q25 & Q75 & n\\
    \hline
    Max depth (m) & 8.2 (7) & 4.6 (3.7) & 14 (12) & 4820 (17700)\\
    \textbf{Area (ha)} & 55 (33) & 21 (11) & 140 (100) & 4820 (17700)\\
    \textbf{Island area (ha)} & 0 (0) & 0 (0) & 0.18 (0.076) & 4820 (17700)\\
    \textbf{Perimeter (m)} & 4400 (3500) & 2500 (1800) & 8100 (7300) & 4820 (17700)\\
    \textbf{Shoreline development} & 1.7 (1.7) & 1.4 (1.4) & 2.1 (2.2) & 4820 (17700)\\
    \textbf{Elevation (m)} & 300 (340) & 180 (210) & 400 (460) & 4820 (17700)\\    
    \textbf{Watershed-lake ratio} & 7.8 (10) & 3.9 (4.4) & 17 (28) & 4820 (17700)\\
    Deepest point distance (m) & 180 (-) & 110 (-) & 290 (-) & 4820 (-)\\
    Mean deepest point distance (m) & 140 (-) & 87 (-) & 230 (-) & 4820 (-)\\
    \textbf{Visual center distance(m)} & 240 (-) & 160 (-) & 390 (-) & 4820 (-)\\
    Inlake slope (m/m) & 0.05 (-) & 0.02 (-) & 0.08 (-) & 4820 (-)\\
    Inlake slope online (m/m) & 0.06 (-) & 0.03 (-) & 0.14 (-) & 4800 (-)\\
    Inlake slopes (m/m) & 0.06 (-) & 0.03 (-) & 0.1 (-) & 4820 (-)\\
    Inlake slopes online (m/m) & 0.07 (-) & 0.03 (-) & 0.15 (-) & 4800 (-)\\
    Mean inlake slope (m/m) & 0.04 (-) & 0.02 (-) & 0.09 (-) & 4820 (-)\\
    Nearshore mean slope (m/m) & 0.08 (-) & 0.05 (-) & 0.11 (-) & 4820 (-)\\
    Nearshore slope online (m/m) & 0.08 (-) & 0.04 (-) & 0.13 (-) & 4590 (-)\\
    Nearshore slopes online (m/m) & 0.08 (-) & 0.04 (-) & 0.13 (-) & 4540 (-)\\
    \bottomrule
    \end{tabular}  
  \end{table}

By definition, the distance proxy (distance to the center of the waterbody) must always be greater or equal to the true distance value (distance to the deepest point of the waterbody). Therefore, we expect that the use of this proxy will lead to overestimation of waterbody depth (Fig. \ref{fig1}). Furthermore, we expect to see greater overestimation error in reservoirs as compared to natural lakes because many reservoirs are known to be drowned river valleys where the deepest point is close to the edge at the end of the reservoir (i.e. next to the dam) rather than in the center of the reservoir \citep{lanza1985interactions}. In a similar fashion, we expect to see overestimation error associated with using a nearshore land slope proxy in waterbodies with differing cross-section shape such that the depth of bowl-shaped (i.e. concave) waterbodies will be overpredicted whereas the depth of V-shaped (i.e. convex) waterbodies will be underpredicted (Fig. S1). Finally, we expect that depth predictions themselves will be strongly related to waterbody area and hydrologic subbasin variables as these measures have been influential in prior studies \citep{oliver2016prediction}.

By testing these expectations, we can establish whether barriers to increased depth prediction accuracy lie in lack of correspondence between true and proxy measures of waterbody geometry or in particular characteristics among waterbodies (such as waterbody cross-section shape or reservoir status). This information could help direct future research efforts to focus on particular dimensions of waterbody geometry (i.e. horizontal versus vertical) or to stratify model predictions based on specific waterbody types and cross-section shapes. Ultimately, achieving increased depth prediction accuracy would allow for more precise estimates of depth-dependent biotic and chemical processes across broad spatial extents.

## Methods
### Data description
We compiled bathymetry data on approximately 5,000 waterbodies in the Northeastern and Midwestern United States from nine official state databases (Fig. \ref{fig2}). These represent approximately 15% of all waterbodies in the States included in our study and are a diverse cross section in terms of their characteristics, surface areas, and span a wide geographic extent including glaciated and non-glaciated regions (Table \ref{table1}). Thus, they can be considered representative of the entire population of lakes in our study extent.

\begin{figure}[H]
  \begin{center}
    \includegraphics[width=0.45\textwidth,keepaspectratio]{../figures/00_map_bathy-1.pdf}
  \end{center}
  \caption{Map of study lakes showing A) lake e maximum depth measurements, B) cross-section shape class, and C) reservoir classification. The distribution of lake depths from panel A is reported in Figure S4.}\label{fig2}
\end{figure}

The original data came in a variety of formats including pre-interpolated rasters (Minnesota), contour lines (Nebraska, Michigan, Massachusetts, Kansas, Iowa), contour polygons (New Hampshire, Connecticut), or point depth soundings (Maine). For the Minnesota data, we simply clipped the raster for each waterbody to its outline. For data from the remaining States, we processed each waterbody by converting its original representation to a point layer (if necessary), rasterizing these points, and creating an interpolated bathymetry “surface” using a simple moving window average in the \texttt{raster} R package \citep{hijmansRasterGeographicData2019}. The size of the moving window was adjusted iteratively to ensure that each bathymetry raster contained no missing data.

All waterbody bathymetry was specifically calculated relative to high-resolution (1:24,000 scale) National Hydrography Dataset \citep{usgsNationalHydrographyDataset2019} waterbodies such that source data and bathymetry surface outputs were clipped to the area of each waterbody polygon. We restricted the waterbodies in our study to those with an area of at least 4 ha and a maximum depth of at least 0.3 m (1 ft.). The purpose of these restrictions was to ensure that waterbodies had enough contours (or points, or polygons) to generate adequately smooth interpolations with which to calculate in-lake geometry metrics.

We used our generated bathymetry surfaces to find the location of the deepest point in the waterbody and we resolved ties by choosing the deepest point that was closest to the center of the waterbody. We used the location of this deepest point to calculate "distance to the deepest point" as the minimum distance to the waterbody shoreline. To account for waterbodies where the centroid does not intersect waterbody bathymetry because it is located within an embedded island or peninsula, we calculated the center of the waterbody not as its centroid but rather by finding the point farthest from the waterbody shoreline (i.e. its “visual distance to waterbody center”). For these calculations, we used the \texttt{polylabelr} R package \citep{larssonPolylabelrFindPole2019}, which interfaces with the Mapbox pole of inaccessibility algorithm \citep{agafonkinJSLibraryFinding2019}. We calculated (maximum) in-lake slope as depth at the deepest point divided by the shortest distance to the deepest point from the shoreline. We calculated (mean) nearshore land slope for each waterbody by computing the slope within a 100-m buffer using data from a high-resolution digital elevation model (~ 15x15m grain) accessed using the \texttt{elevatr} R package \citep{hollisterElevatrAccessElevation2017}. We explored alternative buffer sizes ranging between 50-1000 m following \citet{sobekPredictingDepthVolume2011} and although 100 m provided the lowest model error, we ultimately found little appreciable effect of varying buffers on model performance. Slope computations proceeded by passing a 3x3 moving window over the 100-m buffer to calculate the slope at each point using Horn's algorithm via the terrain function in the \texttt{raster} R package \citep{hijmansRasterGeographicData2019}. Reported nearshore land slope values are the mean of all points in the buffer. In addition to the aforementioned techniques of calculating in-lake (and nearshore) slopes and distances, we tried 7 alternate techniques which are described in Fig. S5 and Table S2 including measures such as median slope (results not shown).

We categorized waterbodies based on their cross-section shape and reservoir class (e.g. natural lake, reservoir). For cross-section shape, we categorized waterbodies as either convex or concave following the method of \citet{hakansonLakeFormLake1977} by computing normalized waterbody depth-area relationships (i.e. hypsographic curves) and assigning class membership based on whether the midpoint of a waterbody’s curve falls above or below that of a simple straight-sided cone (Fig. S2).

We further categorized waterbodies using the output of a deep convolutional neural network model trained on satellite images labelled according to whether there was visual evidence of a water control structure significantly impacting flow \citep{polus2020}. This model had an overall validation accuracy of 81% and produced a probability for each waterbody as to whether it is a reservoir or a natural lake. For our purposes, we set a conservative classification probability threshold of 0.75 to determine whether a waterbody would be considered a reservoir. For example, if the \citet{polus2020} dataset classified a particular waterbody as a reservoir with a probability of 0.74 we categorized it as a natural lake but if the probability was greater than 0.75 we categorized it as a reservoir. Note that our reservoir classification defines reservoirs as any permanent waterbody that has a water control structure likely to significantly impact flow or pool water. It makes no distinction between different dam types, heights, or uses/purposes because the \citet{polus2020} dataset is only based on visual interpretation of waterbody images (via deep convolutional neural network models). However, the \citet{polus2020} dataset is unique in that it provides data using a standardized approach at broad spatial extents for waterbodies > 4 ha.

Covariates used in random forest modeling (Table \ref{table1}, Equation \ref{eq3}, see Random Forests Model sub-section below) for waterbody elevation, area, island area, perimeter, shoreline development, watershed to waterbody area ratio, and hydrologic subbasin (i.e. HUC4s), were obtained from the LAGOS-US LOCUS database. One such measure, that of shoreline development, is a measure of waterbody perimeter shape defined as:

\begin{align}
shoreline_{devel} = perimeter / (2 * \sqrt{(\pi * waterarea * 10000)}) \label{eq2}
\end{align}

\noindent where sinuous waterbodies have larger values of shoreline development and circular waterbodies have smaller values of shoreline development. Watershed to waterbody area ratio is an approximation of water residence time and is defined as watershed area divided by waterbody area \citep{timmsGeomorphologyLakeBasins2009}.

### Proxy evaluation
We conducted a qualitative assessment of whether or not proxy measures of waterbody geometry (e.g.  nearshore land slope, distance to the center of the waterbody) are representative of their true values (e.g. in-lake slope, distance to the deepest point of the waterbody) by visual inspection (i.e. plotting each proxy measure against its corresponding true value) and by computing coefficients of determination ($R^2$). We further tested proxy measures by examining their effect on waterbody depth prediction error. Our approach involved several steps. In the first step, we computed a geometric estimate of waterbody depth using only geometry information ($depth_{geometric}$, Equation \ref{eq1}). In the second step, we fit a random forest model to predict observed (i.e. true) depth as a function of geometric depth along with several covariates available for all waterbodies (Table \ref{table1}). The purpose of this random forest “offset” modeling was to more rigorously test our expectations regarding prediction error among different formulations of $depth_{geometric}$ and among different waterbody types. Each of these steps were executed iteratively for each combination of true and proxy values of slope and distance (Table \ref{table2}). We conducted additional sensitivity analysis to examine possible interactions between different proxy measures of waterbody geometry and different subsets of the entire dataset where model data was restricted (i.e. “filtered”) to include only reservoirs, only natural lakes, only convex waterbodies, or only concave waterbodies (Table \ref{table2}). 

\begin{table}
  \caption{Model fit and predictive accuracy metrics (RMSE = root mean square error, R2 = coefficient of determination, MAPE = mean absolute percent error) for all combinations of true (in-lake slope, distance to the deepest point of the waterbody) and proxy (nearshore land slope, distance to waterbody center) metrics.} \label{table2}
  \centering
  % \setlength\tabcolsep{1.5pt} % default value: 6pt
\begin{tabular}{llllll}
\hline
Filter & Slope & Distance & RMSE & $R^2$ & MAPE\\
\hline
all & true & true &  &  & \\
 & true & proxy & 4.8 m & 0.73 & 27 \%\\
 & proxy & true & 7.3 m & 0.31 & 64 \%\\
 & proxy & proxy & 7.1 m & 0.36 & 61 \%\\
\hline
reservoir & true & true &  &  & \\
 & true & proxy & 5.3 m & 0.66 & 36 \%\\
 & proxy & true & 7 m & 0.40 & 61 \%\\
 & proxy & proxy & 7 m & 0.41 & 60 \%\\
\hline
natural lake & true & true &  &  & \\
 & true & proxy & 4.1 m & 0.74 & 22 \%\\
 & proxy & true & 6.7 m & 0.26 & 68 \%\\
 & proxy & proxy & 6.6 m & 0.29 & 64 \%\\
\hline
convex & true & true &  &  & \\
 & true & proxy & 4.7 m & 0.74 & 30 \%\\
 & proxy & true & 7.2 m & 0.34 & 59 \%\\
 & proxy & proxy & 6.9 m & 0.39 & 58 \%\\
\hline
concave & true & true &  &  & \\
 & true & proxy & 1.6 m & 0.78 & 20 \%\\
 & proxy & true & 3.1 m & 0.14 & 46 \%\\
 & proxy & proxy & 3 m & 0.17 & 45 \%\\
\bottomrule
\end{tabular}
\end{table}

## Model description
### Geometric model 
We used a geometric model of waterbodies where basins are treated as cones with a fixed relationship between slope and distance (Equation \ref{eq1}). One reason that we used the cone model is that, unlike other idealized shapes, it does not require any knowledge of waterbody volume or mean depth. Note that Equation \ref{eq1} is a geometric formula and has no intercept or coefficients and it produces an exact depth value given true values of slope and distance. To use this model to predict the depth of all waterbodies, there is a necessary assumption that proxy slope and distance measures, which are available for all waterbodies, are representative of true slope and distance (Fig. \ref{fig1}).

### Random forest models
Prior studies using geometric models to predict waterbody depth include a statistical or machine learning model “layer” or “offset” to boost predictive accuracy \citep{hollisterPredictingMaximumLake2011, yigzawNewGlobalStorage2018}. This procedure involves fitting a statistical or machine learning model to the residuals of an initial geometric model. For our purposes, such offset modeling enabled us to test our expectations that prediction error would be different among different formulations of $depth_{geometric}$ and among different waterbody types. It also facilitated direct comparison against prior models of waterbody depth including those that are non-geometric. We generated an “offset” to geometric depth (sensu \citealt{hollisterPredictingMaximumLake2011}) using the random forest algorithm and the \texttt{ranger} R package \citep{wrightRangerFastImplementation2017} to predict observed maximum depth as a function of covariates including geometric maximum depth (from Equation \ref{eq1}) along with the waterbody elevation, area, perimeter, and ratio/index measures listed in Table \ref{table2}:

\begin{align}
  depth_{observed} \sim depth_{geometric} + covariates \label{eq3}  
\end{align}

\noindent We evaluated the relative “importance” of individual covariates by comparing model performance between 1) models where a given covariate was left untouched versus 2) models where a given covariate was permuted randomly \citep{prasadNewerClassificationRegression2006, wrightRangerFastImplementation2017}. Neither cross-section shape nor reservoir class was used as a covariate in any random forest models. Random forest training and test data was stratified on shape and reservoir class to match that of the overall waterbody population. We used the random forest algorithm because it makes no assumptions about the distribution of model residuals, allows for non-linearity, and is insensitive to interactions (i.e. multicollinearity) among covariates \citep{prasadNewerClassificationRegression2006}. 

### Model comparisons
We tested model sensitivity to slope and distance proxies by generating multiple “geometric maximum depth” estimates from 3 different model runs using each of the possible metric combinations for Equation \ref{eq1} (true slope - proxy distance, proxy slope - true distance, proxy slope - proxy distance). Prior to entry into Equation \ref{eq1}, we standardized proxy distances to have the same numeric range as their true counterpart. The purpose of this standardization was to prevent waterbodies with extremely long proxy distances from having an outsized impact on model evaluation metrics. In addition to comparing among model runs using different metric combinations, we compared among sets of model runs where slope and distance measures were calculated using different sets of calculation techniques (Table S2). 

### Model evaluations
We evaluated model fit and prediction error using root-mean-square error (RMSE), mean absolute percent error (MAPE), and coefficient of determination ($R^2$) metrics on a holdout set (i.e. a data subset not used for model training) containing 25% of all waterbodies. We evaluated the residuals of each model relative to waterbody cross-section shape and reservoir classes to determine whether depth is consistently over or under predicted for some waterbody types relative to others.

## Results
Waterbodies belonging to each cross-section shape and reservoir class were not evenly distributed across our study area (Fig. \ref{fig2}). For example, concave waterbodies were nearly absent from Michigan whereas Maine had an overabundance (~3%) of waterbodies categorized as neither concave nor convex. Waterbodies in the southern portions of our study area tended to be classified as reservoirs whereas waterbodies in the northern portions of our study area were a more even mix between reservoirs and natural lakes (Fig. \ref{fig2}). Approximately 18%, 80%, and 2% of waterbodies were classified as having a concave, convex, or neither shape respectively whereas approximately 30% and 70% of waterbodies were classified as being a reservoir or a natural lake.

Although proxy distance to waterbody center was often larger in magnitude compared to the true distance to the deepest point of waterbodies’ (rather than being identical), they were strongly related ($R^2$ = 0.8). Note that the coefficient of determination for this relationship is not strictly correct given that distance to waterbody center is an upper bound on distance to the deepest point of waterbodies. In contrast to distance metrics, proxy nearshore land slope and true in-lake slope were more weakly related ($R^2$ = 0.17). For slope measures, most waterbodies had higher magnitude (i.e. steeper) nearshore land slope compared to true in-lake slope (Fig. \ref{fig3}). Taken together, these results suggest that proxy distance to the center of waterbodies is representative of true distance to the deepest point of waterbodies whereas proxy nearshore land slope is not representative of true in-lake slope. The strong relationship between distance to the center of waterbodies and distance to the deepest point means that it is possible to convert between the two measures in subsequent analyses (See best-fit equations in Fig. \ref{fig3}).

\begin{figure}[H]
  \begin{center}
    \includegraphics[width=0.45\textwidth,keepaspectratio]{../figures/01_geometry_base-1.pdf}
  \end{center}
  \caption{Comparison among proxy and true values of lake geometry for A) distance to deepest point versus distance distance to lake center and B) nearshore land slope versus in-lake slope. A best-fit line (solid) and equation is shown to shown to facilitate computation of correction factors for proxy values of lake geometry. A 1:1 line (dashed) is shown to illustrate bias. Coefficients of determination are shown to illustrate representativeness.}\label{fig3}
\end{figure}

In addition to overall differences between slope and distance measures, we found differences in these relationships among waterbody shape classes. For example, in-lake slope and distance to the deepest point of the waterbody metrics were consistently larger in magnitude for convex waterbodies as compared to concave waterbodies (Fig. S3). We found evidence that this difference was at least partly explained by the fact that convex waterbodies are deeper than concave waterbodies (Fig. S8). Unlike concave and convex waterbodies, there were not clear differences among slope and distance metrics for natural lakes versus reservoirs.

Offset model fit and prediction error differed depending on the technique used to calculate in-lake and nearshore geometry metrics (Table S2). We found that the best model fit and lowest model error occurred when in-lake slope was calculated as the average point-wise slope of all points at maximum waterbody depth rather than at single point of maximum depth. However, given the small difference in the fit of models using either of these techniques and the significant cost in terms of computational load and complexity, we limit our discussion hereafter to the simpler case involving only a single deepest point.

The use of proxy nearshore land slope had a larger effect on model fit and prediction error than the use of proxy distance to waterbody center (Table \ref{table2}). More specifically, the true slope (in-lake slope) - proxy distance (distance to the center of the waterbody) model had a better fit ($R^2$ = 0.73) and lower prediction error (RMSE = 4.8m, MAPE = 27%) compared to the proxy slope - true distance model ($R^2$ = 0.31, RMSE = 7.3m, MAPE = 64%). The fit of the proxy slope -proxy distance model ($R^2$ = 0.36, RMSE = 7.1m, MAPE = 61%) was very similar to the proxy slope – true distance model. Predicted depth values for this model were generally underestimates relative to measured depth values (Fig. S9).

Furthermore, analysis of model residuals showed overestimation of waterbody depth for concave waterbodies when models included a proxy slope measure (Fig. \ref{fig4}). We observed similar but smaller overestimation depending on if a waterbody was classified as a reservoir rather than a natural lake (Fig. \ref{fig4}). We found that models restricted to consider only concave lakes had lower error (both in absolute and relative terms) compared to models on other data subsets (e.g. convex lakes, reservoirs, natural lakes, see Table \ref{table2}). Conversely, we did not observe any notable geographic patterns in model residuals (Fig. S6). 

\begin{figure*}
  \begin{center}
    \includegraphics[width=0.75\textwidth,keepaspectratio]{../figures/02_depth_model_grid_resid-1}
  \end{center}
  \caption{Depth model residuals (residual  = observed - predicted) in meters by cross-section shape and reservoir class indicating overprediction of concave and reservoir lakes.}\label{fig4}
\end{figure*}

The most important covariates in these models were those relating to spatial location, waterbody area, and perimeter (Fig. \ref{fig5}). Conversely, watershed metrics and waterbody elevation had little contribution to random forest model fit. The spatial location (i.e. HUC4, hydrologic subbasin) covariate was notably less important in the true slope model compared to the two proxy slope models. To evaluate the contribution of our “offset” models relative to the “base” geometric model, we can look at model importance calculations for the geometric max depth input to the random forest model (Fig. \ref{fig5}). These calculations indicate that omitting a geometric max depth term results in a 130%, 60%, or 50% increase in mean square error depending on the formulation of geometric max depth in Eq. \ref{eq1}.

\begin{figure}
  \begin{center}
    \includegraphics[width=0.45\textwidth,keepaspectratio]{../figures/02_depth_model_importance-1.pdf}
  \end{center}
  \caption{Importance plot for random forest variables showing increase in mean square error. Higher values indicate greater importance to model predictions. See Equation \ref{eq1} for a definition of geometric max depth. HUC4 ID is a 'dummy' variable of geographic (hydrologic subbasin) location.}\label{fig5}
\end{figure}

## Discussion

Our tests of the geometric cone model of waterbody depth models show that specific proxy measures of waterbody geometry are not representative of true geometry measures across a broad array of waterbodies. Models using non-representative proxies showed increased error and systematic overestimation of depth in concave and reservoir waterbodies. Although our analysis was limited to waterbodies with available bathymetry data, these waterbodies did not have characteristics that differed from that of the overall waterbody population (apart from the fact that our study waterbodies were somewhat larger in area compared to the overall waterbody population, See Fig. S7, Table \ref{table1}, Fig. S10). Although there is a possibility that there is some hidden bias not explored for in our analyses, this lack of difference suggests that our results are likely to be broadly applicable to nearly all waterbodies in the study area. 

### Representativeness of proxy measures of waterbody geometry
In comparing among waterbody geometry measures, our analysis suggests that proxy distance to waterbody center is representative of true distance to the deepest point of the waterbodies, but that proxy nearshore land slope is not representative of true in-lake slope. A simple indication of this non-representativeness is that proxy nearshore land slope was often (in > 74% of cases) steeper than true in-lake slope. This finding is consistent with \citet{heathcotePredictingBathymetricFeatures2015} whose results suggest that in-lake slopes are shallower compared to the surrounding land. Furthermore, the fact that in-lake slopes were shallower compared to the surrounding land even after controlling for differences in area (Fig. S4) is consistent with the idea of topographic scaling (i.e. scale invariance) explored in previous work and detailed by \citep{caelVolumeMeanDepth2017}. The underlying reason for these shallow in-lake slopes may be related to slope-induced turbidity currents which distribute sediment from shallow high-energy areas of waterbodies to deep low-energy areas \citep{hakansonLakeBottomDynamics1981, johanssonNewApproachesModelling2007}. The strength of such sediment focusing is likely greater in "younger" waterbodies with steeper slopes leading to a smoothing of their bathymetry over time \citep{blaisInfluenceLakeMorphometry1995}.

One surprising finding with respect to the relationship between true and proxy geometry measures when examined by waterbody class was the fact that there was no greater difference between proxy and true distances in reservoirs compared to natural lakes. This is contrary to the idea that most reservoirs are drowned river valleys where the deepest point is close to the edge at the end of the reservoir (i.e. next to the dam) rather than in the center of the reservoir \citep{lanza1985interactions}. One possible explanation is that our reservoir classification data uses a more general definition of a reservoir (i.e. any permanent waterbody that has a water control structure likely to significantly impact flow or pool water) compared to that of conventional classifications that are tied to specific dam types or dam heights. Another possible explanation is that conventional reservoir classifications are conceptually biased towards more southern areas with few natural lakes (Figure 2). Southern Iowa, for instance is typically considered to have few to no natural lakes. In the present study, all of the apparent natural lakes in Southern Iowa were in fact oxbow lakes adjacent to the Missouri River. 

We found other differences among waterbody geometry measures according to waterbody cross-section shape. One finding was that convex waterbodies, when compared to concave waterbodies, had longer distances to waterbody centers relative to corresponding distances to the deepest point of waterbodies. In addition, convex waterbodies often had steeper in-lake slopes relative to nearshore land slopes as compared to concave waterbodies. Finally, it was notable that convex waterbodies were deeper than concave waterbodies despite having similar distributions of waterbody surface area (Fig. S8). The underlying cause of these differences is unknown but one possibility is that geometry is tied to the circumstances of waterbody formation whereby the formation of concave waterbodies were a result of more intense glacial scouring compared to that of convex waterbodies \citep{gorhamPhysicalLimnologyNorthern1958}. While our findings provide some evidence in support of this idea, namely that there is a geographic hotspot of concave waterbodies associated with the glaciated “prairie pothole region” (see \citealt{hayashiSimpleEquationsRepresent2000}), the overall geographic distribution of waterbody cross-section shapes does not support this idea. Instead of a concentrated area of concave waterbodies in formerly glaciated regions, there appears to be a fairly even mix of concave and convex waterbodies distributed amongst the northern (i.e. glaciated) and southern (non-glaciated) portions of our study area (Fig. \ref{fig2}).


### Effects of proxy measures of waterbody geometry depth prediction error
Models using only proxy variables (Table \ref{table2}) had prediction error rates (RMSE = 7.1m) of a similar magnitude as that of prior studies (RMSE = 6 - 7.3m) predicting waterbody depth at broad geographic extents \citep{hollisterPredictingMaximumLake2011, messagerEstimatingVolumeAge2016, oliver2016prediction}. When only a single proxy measure was used, there was a difference in model sensitivity depending on if it was a horizontal distance measure or a vertical slope measure. In the case of a true slope and proxy distance combination, models were more accurate (± 4.8m, 27%) than even the most accurate of prior studies \citep{hollisterPredictingMaximumLake2011, messagerEstimatingVolumeAge2016, oliver2016prediction}. Conversely, models using a proxy slope and true distance combination had prediction error rates (± 7.3m, 64%) of a similar magnitude as that of the baseline proxy-proxy model (± 7.1m, 61%). The greater sensitivity of depth predictions to proxy slope measures relative to proxy distance measures may be explained by the fact that proxy slope measures were a more imperfect representation of true in-lake slopes relative to proxy versus true distances. We did not find evidence that the sensitivity of depth predictions to slope was dependent on variations in how these measures were calculated (Table S2). In a general sense, the sensitivity of depth predictions to slope help explain the relatively poor predictive performance of prior non-geometric waterbody depth models given that they rely heavily on waterbody area as a predictor \citep{sobekPredictingDepthVolume2011, messagerEstimatingVolumeAge2016, oliver2016prediction} and both horizontal distance measures and vertical slope measures appear to be decoupled from waterbody area (Fig. S8). 

### Effects of waterbody shape and waterbody type on depth prediction error
As expected, we found that the maximum depth of concave waterbodies was systematically overpredicted by a simple geometric model using proxy nearshore land slope (Fig. S1). However, contrary to our expectation, we did not observe underprediction of depth in convex waterbodies. The reason we did not observe underprediction of the depth of convex waterbodies is likely because geometric depth itself was always greater than observed maximum depth owing to the fact that proxy distance is constrained to be greater than true distance. Given that models restricted to only concave waterbodies had low error (both in absolute and relative terms), this suggests that despite evidence of overprediction, the cone model is an adequate representation of depth for these waterbodies.

### Future research
The only model parameterization that was more accurate than the most accurate of prior studies fitting models to waterbody depth data requires data on in-lake slope (true slope, proxy distance) which is not available for all waterbodies thus it is not of practical use for general prediction. However, we propose that the error rate of this model (± 4.8m, 27%) be used as an out-of-sample prediction benchmark for future studies such that they should attempt to match it but not expect to exceed it.

Because this most accurate model requires bathymetry data, this suggests that it may not be possible with current data and models to produce depth predictions for all waterbodies with error rates below about 5m or 30%. To achieve high prediction accuracy using data available for all waterbodies, future studies could explore alternative modeling approaches such as ordinal modeling, which would capture whether or not a waterbody crosses some important depth threshold but would not seek to predict a specific depth value, or emerging data types such as “topobathymetric” products that integrate both topographic and bathymetric data in a seamless fashion rather than treating them as separate entities. Topobathymetry would allow for more robust tests of the representativeness of geometric model inputs. Unfortunately, topobathymetric products are rare, have mostly been limited nearshore marine environments, and as such are not yet widely available for inland waters \citep{danielsonTopobathymetricElevationModel2016}. Other potential explanatory data include information on waterbody origin and development. Unfortunately, such “waterbody ontogeny” data is presently available only for select regions and the very largest waterbodies \citep{sharmaComparisonTitanNorth2011}.

Finally, our findings indicate that geometry measures differ according to waterbody cross-section shape. This makes it an attractive target for inclusion in depth prediction models. Unfortunately, identifying a waterbody’s cross-section shape requires bathymetry data which is unavailable for most waterbodies. However, given the conceptual links between cross-section shape, glaciation, and sedimentation \citep{johanssonNewApproachesModelling2007} it may be advantageous for future studies to compile data on sedimentation to determine if this data can be used to predict cross-section shape and boost depth prediction accuracy. We note that such data does not currently exist for large numbers of waterbodies.

## Conclusion
To our knowledge, the present study is the largest and most comprehensive test to date of the geometric cone model of waterbody depth. Using bathymetry data on approximately 5,000 waterbodies, we show that proxy slope measures are not representative of true in-lake slope and this leads to overestimates of depth in concave and reservoir waterbodies. Despite these apparent biases, overall prediction accuracy was equivalent to that of prior depth prediction studies (± 6-7m). In addition, models restricted to only concave waterbodies had low error (both in absolute and relative terms) suggesting that the cone model is an adequate representation of depth for these waterbodies.

Only our models using a true measure of in-lake slope had greater accuracy than that of prior studies (± 4.8m, 27%). Given that this model requires data which is only available for waterbodies with bathymetry data, it is of limited use for general depth prediction. Lack of improved prediction accuracy (short of including data that is unavailable for most waterbodies) suggests that improved prediction may require new types of data or novel analysis techniques.

## Data availability

All data used in the study is available at \citet{stachelekjemmaBathymetryData0002021}. All code for data processing, model fitting, and model evaluation is available at \citet{jemstachelekContlimnoBathymetryAccepted2021}.
